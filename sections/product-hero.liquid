{% assign current_variant = product.selected_or_first_available_variant %}
{% assign is_available = false %}
{% for variant in product.variants %}
    {% if variant.inventory_quantity > 0 %}    
        {% assign is_available = true %}
    {% endif %}
{% endfor %}

<section class="product__hero pt-20 md:pt-0">
    <div class="container md:px-0">
        <div class="sticky__parent grid grid-cols-7 gap-20 lg:gap-9 md:block">
          <div class="col-span-4 md:col-span-1">
            <div class="grid grid-cols-[80px_1fr] gap-9 md:grid-cols-1">
              <div class="hidden md_min:block">
                <div class="sticky top-[60px]">
                  <div class="product__nav-gallery grid gap-8">
                    {% for image in product.images %}
                        <a href="#product-image-{{ forloop.index }}" class="product__nav-gallery-item"><img src="{{ image.src | img_url: '300x300', crop: 'center' }}" width="300" height="300" alt="{{ image.alt }}" loading="lazy"></a>
                    {% endfor %}
                  </div>
                </div>                
              </div>
              <div class="md:col-span-1">
                <div class="product__main-gallery grid gap-8 md:-mt-[80px]">
                  {% for image in product.images %}
                      <img id="product-image-{{ forloop.index }}" src="{{ image.src | img_url: '1200x1200', crop: 'center' }}" class="fade-in scroll-m-8" width="1200" height="1200" alt="{{ image.alt }}" loading="lazy" data-viewport>
                  {% endfor %}
                </div>
              </div>
            </div>
   
              <div>
                  <div class="font-matterlight text-24 toggle-trigger relative ml-8 mb-4 cursor-pointer md:text-20" data-container="info-guarantee">Test</div>
                  <div id="info-guarantee" class="text-17 leading-[1.59] toggle-container ml-8">STUFF</div>      
              </div>
  
          </div>
          <div class="sticky__scroller-wrap pb-20 col-span-3 md:col-span-1 md:p-5" data-top-spacing="150">
            <div class="sticky__scroller">  
              {% if product.collections %}
                  {% for collection in product.collections limit:1 %}
                      <div class="font-italic text-24 -mb-1">{{ collection.title }} â€”</div>
                  {% endfor %}
              {% endif %}
              <h1 class="font-matterlight text-24 tracking-[.05em] mb-5">{{ product.title }}</h1>
              <p class="font-matter text-brown tracking-widest mb-5">{{ product.price | money_without_trailing_zeros }}</p>
              {% if product.has_only_default_variant %}
                <div class="border-t border-brown mb-4"></div>
              {% endif %}
              {% form 'product', product, id: 'add-to-cart', data-product-handle: product.handle %}

                  <select id="product-select" name="id" style="display:none;">
                      {% for variant in product.variants %}
                        {% if variant.available %}
                          <option value="{{variant.id}}" data-qty="{% if variant.inventory_management != blank %}{{ variant.inventory_quantity }}{% else %}9999{% endif %}"> {{ variant.title }} for {{ variant.price | money_with_currency }}</option>
                        {% else %}
                          <option value="{{variant.id}}" disabled="disabled" data-qty="{{ variant.inventory_quantity }}"> {{ variant.title }} - sold out!</option>
                        {% endif %}
                      {% endfor %}
                  </select>  
    
                  {% unless product.has_only_default_variant %}
                    {% for option in product.options_with_values %}
                    {% assign optionindex = forloop.index0 %}
                      {% if option.name contains 'Color' %}
                        <div class="border-t border-brown mb-4"></div>
                        <div class="swatch__group-wrap mb-6"{% unless is_available %} style="pointer-events:none;"{% endunless %} data-option="{{ optionindex }}">
                          <div class="swatch__group mr-6 md:mr-0 md:mb-6{% unless is_available %} disabled{% endunless %}">
                            <div class="flex items-end mb-2">
                              <div class="swatch__label font-matter text-13">Color: {% if optionindex == 0 %}{{ current_variant.title | split: ' / ' | first }}{% else %}{{ current_variant.title | split: ' / ' | last }}{% endif %}</div>
                            </div>
                            <div class="flex items-center">
                              {% for value in option.values %}
                                {% for tag in product.tags %}
                                  {% if tag contains value %}
                                    {% assign swatch_color = tag | split: ': ' | last %}
                                  {% endif %}
                                {% endfor %}                             
                                <div class="swatch__wrap relative mr-3{% if current_variant.title contains value %} active{% endif %}">
                                  <input type="radio" id="{{ value | handleize }}" name="Color" value="{{ value }}" data-title="{{ value }}" class="swatch__radio {{ value | handleize }} absolute left-0 -top-[3px] h-full w-full opacity-0" data-qty-{{ variant.option1 | handleize }}="{{ variant.inventory_quantity }}" data-option="{{ optionindex }}"{% if current_variant.title contains value %} checked{% endif %}>
                                  <span class="swatch {{ value | handleize }} inline-block rounded-full w-[18px] h-[18px]" style="background-color: {{ swatch_color }};"></span>
                                </div>
                              {% endfor %}
                            </div>
                          </div>
                        </div>          
                      {% elsif option.name contains 'Size' %} 
                        <div class="border-t border-brown mb-4"></div> 
                        <div class="size__group-wrap mb-2 input-row"{% unless is_available %} style="pointer-events:none;"{% endunless %} data-option="{{ optionindex }}">
                          <div{% unless is_available %} class="disabled"{% endunless %}>
                            <div class="flex items-center mb-2">
                              <div class="size__label font-matter text-13">Select a Size</div>
                            </div>
                            <div class="flex items-center flex-wrap md:flex-nowrap md:overflow-auto">
                              {% for value in option.values %}  
                                <div class="size__button relative mr-3{% for option in current_variant.options %}{% if option == value %} active{% endif %}{% endfor %}">
                                  <input type="radio" id="{{ value }}" name="Sizes" value="{{ value }}" data-title="{{ value }}" class="size__radio absolute left-0 -top-[3px] h-full w-full opacity-0"{% for variant in product.variants %}{% if variant.title contains value %} data-variant-id="{{ variant.id }}" data-qty="{{ variant.inventory_quantity }}"{% endif %}{% endfor %}{% for option in current_variant.options %}{% if option == value %} checked{% endif %}{% endfor %}>
                                  <span for="{{ value }}" class="radio-button-label form-label">{{ value }}</span>
                                </div>
                              {% endfor %}    
                            </div>
                          </div>
                        </div>                                       
                      {% endif %}

                    {% endfor %}
                  {% endunless %}

                  <div class="text-17 leading-[1.59] space-y-8 mb-10">{{ product.description }}</div>
                  <div class="mb-10"><a href="#" class="font-matter tracking-wider text-13 leading-tight text-brown pb-1 border-b border-brown hover:text-orange hover:border-orange">Share</a></div>

                  <input type="number" class="" name="quantity" placeholder="1" id="quantity" style="display:none;">
                  <input type="submit" name="add" id="add" value="Add to Cart" class="button__outline mb-3" onclick="window.addToCart('add-to-cart'); return false;">
                  <div><a href="{{ shop.url }}/cart/{{ current_variant.id }}:1" id="buy-now" class="button w-full block text-center">Buy It Now</a></div>

              {% endform %}                
            </div>
          </div>
        </div>
        <div class="border-b border-brown mt-24 md:mb-9"></div>
    </div>
</section>

{% schema %}
{
    "name": "Hero",
    "class": "hero",    
    "blocks": [
        {
            "type": "info-item",
            "name": "Info Item Toggle",
            "settings": [
                { 
                    "type": "textarea",
                    "id": "title",
                    "label": "Title"
                },
                { 
                    "type": "richtext",
                    "id": "description",
                    "label": "Description"
                }                
            ]
        }
    ]
}
{% endschema %}